# Code Coverage Quick Reference

## ?? Current Coverage (Measured)

```
???????????????????????????????????????????????????????????????
?                 Omni2FA Code Coverage Summary               ?
???????????????????????????????????????????????????????????????
?  Overall Project Coverage:           14.5%                  ?
?  ??????????????????????????????????????                    ?
???????????????????????????????????????????????????????????????
?  Omni2FA.AuthClient:                 43.7% ?               ?
?  ????????????????????????????????????????                  ?
?                                                             ?
?  AsyncAuthHandler:                    0.0% ??               ?
?  ????????????????????????????????????????                  ?
?                                                             ?
?  Omni2FA.Auth:                        0.0% ??               ?
?  ????????????????????????????????????????                  ?
???????????????????????????????????????????????????????????????
```

## ?? Detailed Metrics

### Line Coverage
- **Covered Lines**: 91
- **Total Coverable Lines**: 624
- **Coverage**: 14.5%

### Branch Coverage
- **Covered Branches**: 27
- **Total Branches**: 213
- **Coverage**: 12.6%

### Method Coverage
- **Covered Methods**: 5
- **Total Methods**: 27
- **Coverage**: 18.5%

## ?? AuthClient Detailed Coverage

```
Authenticator Class: 43.7%
?? Constructor/Initialization     ????????????????  60%
?? AuthenticateAsync()            ????????????????  40%
?? WriteEventLog() methods        ????????????????  30%
?? Helper methods                 ????????????????  80%
```

## ?? Test Statistics

| Project | Tests | Passing | Coverage |
|---------|-------|---------|----------|
| **AuthClient** | 35 | 35 (100%) | 43.7% |
| **Adapter** | 69 | Created* | N/A** |

\* Adapter tests created but require Visual Studio to run  
\** Adapter coverage not measured due to COM interop limitations

## ?? Quick Commands

### Generate Coverage Report
```powershell
.\Generate-Coverage-Report.ps1
```

### View Coverage Report
```powershell
# Open the HTML report
Start-Process .\coverage-report\index.html
```

### Run Tests Only
```powershell
# AuthClient tests
dotnet test Omni2FA.AuthClient.Tests\Omni2FA.AuthClient.Tests.csproj

# Or use the script
.\RunAuthClientTests.ps1
```

## ?? Generated Files

After running coverage generation:

```
coverage-results/
??? authclient-coverage.cobertura.xml    # Raw coverage data

coverage-report/
??? index.html                            # Main report (open this!)
??? summary.html                          # Quick summary
??? Summary.txt                           # Text summary
??? badge_*.svg                           # Coverage badges
```

## ?? Coverage Goals

| Metric | Current | Target | Goal |
|--------|---------|--------|------|
| **AuthClient Line Coverage** | 43.7% | 65% | 80% |
| **AuthClient Branch Coverage** | ~40% | 60% | 75% |
| **Overall Coverage** | 14.5% | 50% | 70% |

## ?? How to Improve Coverage

### To reach 65% AuthClient coverage:
1. ? Mock HTTP responses for success scenarios
2. ? Test with registry configuration values
3. ? Trigger more exception paths
4. ? Test SSL bypass scenarios
5. ? Test basic authentication flow

### Commands to help identify uncovered code:
```powershell
# View detailed HTML report
Start-Process .\coverage-report\index.html

# Look for red/orange highlighted lines in the report
# These are uncovered or partially covered code paths
```

## ?? Coverage Badges

Generated badges in `coverage-report/`:

- **Line Coverage**: ![Line](./coverage-report/badge_linecoverage.svg)
- **Branch Coverage**: ![Branch](./coverage-report/badge_branchcoverage.svg)
- **Method Coverage**: ![Method](./coverage-report/badge_methodcoverage.svg)

## ? Pro Tips

1. **Open the HTML report** - It's interactive and shows exactly which lines are covered
2. **Focus on red lines** - These are uncovered and easy to target
3. **Look for patterns** - Often multiple tests can cover related uncovered areas
4. **Check branch coverage** - Don't just cover lines, cover all if/else paths

## ?? Last Updated

**Date**: October 20, 2025  
**Tool**: Coverlet 6.0.4 + ReportGenerator  
**Test Count**: 35 (AuthClient)  
**Status**: ? Significant improvement from baseline

---

**Pro Tip**: Run `.\Generate-Coverage-Report.ps1` after adding new tests to see your coverage improve in real-time!
