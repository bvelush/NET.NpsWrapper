<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>radutil.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
    <body onload="prettyPrint()">
        <h4></h4>
        <pre class="prettyprint lang-cpp linenums">
#include "pch.h"
#include &lt;windows.h&gt;
#include "radutil.h"

LPVOID WINAPI RadiusAlloc(SIZE_T dwBytes)
<span style = "background-color:#dfd">{
    return HeapAlloc(GetProcessHeap(), 0, dwBytes);
}</span>
VOID WINAPI RadiusFree(LPVOID lpMem)
<span style = "background-color:#dfd">{
    HeapFree(GetProcessHeap(), 0, lpMem);
}</span>
DWORD WINAPI RadiusFindFirstIndex(PRADIUS_ATTRIBUTE_ARRAY pAttrs,DWORD dwAttrType)
<span style = "background-color:#dfd">{</span>
    DWORD dwIndex, dwSize;
    const RADIUS_ATTRIBUTE* pAttr;
<span style = "background-color:#dfd">    if (pAttrs == NULL)</span>
    {
<span style = "background-color:#dfd">        return RADIUS_ATTR_NOT_FOUND;</span>
    }
    /* Get the number of attributes in the array */
<span style = "background-color:#dfd">    dwSize = pAttrs-&gt;GetSize(pAttrs);</span>
    /* Iterate through the array ... */
<span style = "background-color:#dfd">    for (dwIndex = 0; dwIndex &lt; dwSize; ++dwIndex)</span>
    {
        /* ... looking for the first attribute that matches the type. */
<span style = "background-color:#dfd">        pAttr = pAttrs-&gt;AttributeAt(pAttrs, dwIndex);
        if (pAttr-&gt;dwAttrType == dwAttrType)</span>
        {
<span style = "background-color:#dfd">            return dwIndex;</span>
        }
<span style = "background-color:#dfd">    }
    return RADIUS_ATTR_NOT_FOUND;
}</span>
const RADIUS_ATTRIBUTE* WINAPI RadiusFindFirstAttribute(PRADIUS_ATTRIBUTE_ARRAY pAttrs,DWORD dwAttrType)
<span style = "background-color:#dfd">{</span>
    DWORD dwIndex;
<span style = "background-color:#dfd">    dwIndex = RadiusFindFirstIndex(pAttrs, dwAttrType);
    if (dwIndex != RADIUS_ATTR_NOT_FOUND)</span>
    {
<span style = "background-color:#dfd">        return pAttrs-&gt;AttributeAt(pAttrs, dwIndex);</span>
<span style = "background-color:#fdd">    }</span>
    else
    {
<span style = "background-color:#dfd">        return NULL;</span>
    }
<span style = "background-color:#dfd">}</span>
DWORD WINAPI RadiusReplaceFirstAttribute(PRADIUS_ATTRIBUTE_ARRAY pAttrs,const RADIUS_ATTRIBUTE* pSrc)
<span style = "background-color:#dfd">{</span>
    DWORD dwIndex;
<span style = "background-color:#dfd">    if ((pAttrs == NULL) || (pSrc == NULL))</span>
    {
<span style = "background-color:#dfd">        return ERROR_INVALID_PARAMETER;</span>
    }
<span style = "background-color:#dfd">    dwIndex = RadiusFindFirstIndex(pAttrs, pSrc-&gt;dwAttrType);
    if (dwIndex != RADIUS_ATTR_NOT_FOUND)</span>
    {
        /* It already exists, so overwrite the existing attribute. */
<span style = "background-color:#dfd">        return pAttrs-&gt;SetAt(pAttrs, dwIndex, pSrc);</span>
<span style = "background-color:#fdd">    }</span>
    else
    {
        /* It doesn't exist, so add it to the end of the array. */
<span style = "background-color:#dfd">        return pAttrs-&gt;Add(pAttrs, pSrc);</span>
    }
<span style = "background-color:#dfd">}</span></pre>
        <hr />
        <table width="100%">
            <thead>
                <tr>
                    <th align="center">
                        <small>Generated by</small>
                        <a href="https://github.com/OpenCppCoverage/OpenCppCoverage/releases">
                            <strong>OpenCppCoverage (Version: 0.9.9.0)</strong>
                        </a>
                    </th>
                </tr>
            </thead>
        </table>
    </body>
</html>